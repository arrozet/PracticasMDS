model sistemaCoches

 -- CLASES DEL MODELO 

enum TipoRevision { Mantenimiento, Reparacion }

class Clock 
  attributes
    NOW : Integer init = 0 -- POSIX representation starting at 0
    resolution: Integer init = 1 
  operations
    tick() 

    run (n:Integer)
end

abstract class ActiveObject -- real-time objects 
  operations
    tick()
end

association Time between 
  Clock [1] role clock
  ActiveObject [*] role ao ordered
end

class Car < ActiveObject
  attributes
    fechaMatriculacion : String
    kmRecorridos : Integer
    enGarantia : Boolean
    necesitaMantenimiento : Boolean
    speed : Real init: 5
    position : Real init: 0
    isMoving : Boolean init: false
  operations
    accelerate() 
      begin 
        self.speed := self.speed + 1
      end
      post IncreasSpeed: self.speed = self.speed@pre + 1
    decelerate()      
      begin 
        if self.speed > 0 then 
          self.speed := self.speed - 1
      end
      pre 
      post DecresesSpeed: self.speed@pre > 0 implies
                                      self.speed = self.speed@pre - 1
    startMoving()
      begin 
      end 
      pre isNotMoving : not self.isMoving
      post Moving : self.isMoving
    stopMoving()
      begin
        self.isMoving := false
      end
      pre isMoving : self.isMoving
      post notMoving : not self.isMoving
    tick()
      begin 
       if self.isMoving then
        self.position := self.position + self.speed*self.clock.resolution
      end;
    end
    post carMoved : self.isMoving@pre implies
                    self.position = self.position@pre + self.speed*self.clock.resolution


end

class Ciudad
  attributes
    Nombre : String
    Poblacion : Integer
end

class Camino between
  attributes
    distancia : Integer
end

associationclass Viaje between
    Camino [0..1] role caminoCoche
    Coche [0..*] role vehiculo
  attributes
    fechaSalida : Integer
    fechaLlegada : Integer
end

associationclass Revision between
    Taller [0..*] role tallerCoche
    Coche [0..*] role vehiculo
  attributes
    fechaInicio : Integer
    fechaFin : Integer
    tipoRevision : TipoRevision
end 

associationclass Realiza between
        Coche [1] role Coche
        Ciudad [1] role ciudad
      attributes
        fechaSalida : String
        fechaLlegada : String
end


class Taller between
end -- chatgpt dice que se pone así una relación sin atirbutos

class TallerOficial between
  attributes
    tiempoGarantia : Integer
end

class TallerNoOficial between
end

class TallerOficial < Taller
end

class TallerOficial < Taller
end


-------------- Relationships ------------------
association EstOficial between
    TallerOficial [0..1] role tallerOficial
    Ciudad [1] role ciudadTallerOficial
end

association EstaNoOficial between
    TallerNoOficial [0..*] role tallerNoOficial
    Ciudad [1] role ciudadTallerNoOficial
end

association Ubicado between
    Coche [0..*] role vehiculo
    Ciudad [0..1] role ciudadCoche
end

association Ubicado between
    Camino [0..*] role caminoCiudad -- aquí no se poner lo que habeis puesto (nada mas *)
    Ciudad [2] role ciudad
end